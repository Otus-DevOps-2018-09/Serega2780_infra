# Serega2780_infra

Serega2780 Infra repository

Ansible-2

Протестирован режим "один playbook - один сценарий" с переменными, handlers;
Протестирован режим "один playbook - несколько сценариев";
Протестирован режим "несколько playbook";
Provisioning в Packer с режима sh script изменен на Ansible playbook.

Выполнено задание со *.
Установлен/настроен gce.py;
Изменен ansible.cfg так, чтобы использовать динамический inventory из gce.py, а не статический из inventory.yml;
Созданы новые плейбуки site_dynamic.yml, db_dynamic.yml, app_dynamic.yml, deploy_dynamic.yml. Они используют имена виртуальных машин, полученных с помощью gce.py. Таким образом, теперь при пересоздании инфраструктуры с помощью Terraform и, как следствие, изменении внешних ip адресов, пропала необходимость каждый раз прописывать новые адреса в статический inventory.yml. Обращение плейбука происходит по имени машины, которое не меняется при перезапусках.


Ansible-1

Поскольку командой rm -rf ~/reddit удалили каталог reddit, при следующем запуске 
ansible-playbook clone.yml произошел повторный запуск task Clone repo,
чтобы заново создать этот каталог. Поэтому статус changed: [appserver]

Установлен Ansible. Поскольку на ВМ в GC по умолчанию установлен python 3, пришлось в inventory файл добавить строку инициализации
с правльным путем до python на удаленной ВМ. Этот вариант не описывался в методичке к ДЗ ansible_python_interpreter= \
/usr/bin/python3

Выполнены все примеры из ДЗ.

Terraform-2

поднят стенд из двух ВМ, созданных из разных образов
протестировано наличие на них соответствующего ПО mongodb и ruby
код инфтраструктуры разбит по модулям
затем по веткам: stage и prod
создавались buckets


Terraform-1

установлен terraform
создан файл main.tf со всеми настройками
определены и настроены input и output переменные
с помощью terraform развернула ВМ из образа, на ней автоматически запещен сервис puma
через web протестирован функционал сервиса puma
=======

Bastion

bastion_IP = 35.189.195.32
=======
cloud-testapp
testapp_IP = 35.233.40.230
testapp_port = 9292

установлен и настроен gcloud
с помощью gcloud создана ВМ
написаны скрипты для установки Ruby, Mongodb, а также скрипт деплоя приложения


=======
bastion_IP = 35.189.195.32
someinternalhost_IP = 10.132.0.3
